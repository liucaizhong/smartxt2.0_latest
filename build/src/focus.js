"use strict";function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function onForm(e,t){t.stopPropagation();var o=t.target;if("BUTTON"===o.tagName){var a=$(o),n=a.attr("id"),i=!1;switch(n[0]){case"m":if(method!=n[1])switch(method=n[1],i=!0,method){case"0":$("#btnPeriod").find('button[class*="btn-valid"]').removeClass("btn-valid").addClass("btn-invalid"),$("#btnPeriod").children().attr("disabled",!0),period=void 0;break;case"1":$("#btnPeriod").find('button[class*="btn-valid"]').removeClass("btn-valid").addClass("btn-invalid"),$("#p0").attr("disabled",!0),$("#p1").attr("disabled",!1).addClass("btn-valid"),$("#p2").attr("disabled",!1),$("#p3").attr("disabled",!1),period="1";break;case"2":$("#btnPeriod").find('button[class*="btn-valid"]').removeClass("btn-valid").addClass("btn-invalid"),$("#p0").attr("disabled",!1).addClass("btn-valid"),$("#p1").attr("disabled",!1),$("#p2").attr("disabled",!1),$("#p3").attr("disabled",!0),period="0"}break;case"p":period!=n[1]&&(period=n[1],i=!0);break;case"s":source!=n[1]&&(source=n[1],i=!0)}if(i){$("footer.footer").hide(),$(".more-button").find("[class*=active]").removeClass("active");var s=a.siblings('button[class*="btn-valid"]');Array.prototype.forEach.call(s,function(e){$(e).removeClass("btn-valid").addClass("btn-invalid")}),a.removeClass("btn-invalid").addClass("btn-valid"),$(".focus-charts>div.container").empty(),console.log("ajax get focus data!"),console.log(method,period,source),_renderConceptList()}}}function _renderConceptList(){$("div.focus-loading").show();var e;e=method?methodRange[method]+periodRange[period]:methodRange[method];var t=CONCEPTURL+"userId="+loginfo.username+"&source="+sourceRange[source]+"&type="+e;$.ajax({url:t,type:"GET",async:!0,dataType:"json",success:function(e){var t=JSON.parse(e);t=JSON.parse(t),t.length?(conceptList=t,_renderCharts(conceptList.splice(0,CHARTNUM))):($("div.focus-loading").hide(),$(".focus-charts>div.container").empty().html('<div style="font-size:2rem">未找到相关记录</div>'))},error:function(e){console.log(e)}})}function _renderCharts(e){var t=conceptIndicator;conceptIndicator++,e.forEach(function(e,o){var a=HEATURL+"userId="+loginfo.username+"&concepts="+e+"&sources="+source;$.ajax({url:a,type:"GET",async:!0,dataType:"json",success:function(e){var a=JSON.parse(e);if(a=JSON.parse(a),a[0].flag!==-1){var n,i=a[1],s=[],r=[],d=[],l=[],c=[],p={name:i.concept+" H",type:"line",yAxisIndex:0,itemStyle:{normal:{areaStyle:{type:"default",color:"rgba(239,243,246,.6)"},color:"rgb(50,70,90)"}},symbol:"none"},h={name:i.concept+" I",type:"line",yAxisIndex:1,itemStyle:{normal:{areaStyle:{type:"default",color:"rgba(250,225,222,.6)"},color:"rgb(235,85,30)"}},symbol:"none"};s.push({name:i.concept+" H",icon:"line"}),s.push({name:i.concept+" I",icon:"line"}),i.heat.forEach(function(e){l.push(e.heat),c.push(e.index),r.push(e.date)}),p.data=l,d.push(p),h.data=c,d.push(h);var u=document.createElement("div"),b="c"+(t*CHARTNUM+o);$(u).attr("id",b).addClass("focus-chart"),$(".focus-charts>div.container").append(u);var m=echarts.init(document.getElementById(b));m.setOption({baseOption:{title:{},tooltip:{trigger:"axis"},dataZoom:[{handleColor:"rgb(75,188,208)",fillerColor:"rgb(75,188,208)",borderWidth:0,show:!0,realtime:!0,start:75.5,end:100,height:15},{type:"inside",start:5,end:25}],legend:{data:s},toolbox:{feature:{saveAsImage:{}},right:"7%"},xAxis:(n={type:"category",data:r,axisTick:!1,splitLine:{show:!1},axisLine:{show:!0,lineStyle:{type:"solid",width:1,color:"rgb(75,188,208)"}},boundaryGap:!1},_defineProperty(n,"axisTick",!1),_defineProperty(n,"axisLabel",{textStyle:{fontFamily:"微软雅黑",fontSize:12,color:"black"},show:!0}),n),yAxis:[{name:"关注度(H)",type:"value",splitNumber:7,splitLine:{show:!0,lineStyle:{type:"dashed",width:1}},nameTextStyle:{fontFamily:"微软雅黑",fontSize:12,color:"black"},axisLine:{show:!0,lineStyle:{type:"solid",width:1,color:"rgb(75,188,208)"}},axisLabel:{textStyle:{fontFamily:"微软雅黑",fontSize:12,color:"black"},show:!0}},{name:"指数(I)",type:"value",splitNumber:7,splitLine:{show:!1,lineStyle:{type:"dashed",width:1}},nameTextStyle:{fontFamily:"微软雅黑",fontSize:12,color:"black"},axisLine:{show:!0,lineStyle:{type:"solid",width:1,color:"rgb(75,188,208)"}},axisLabel:{textStyle:{fontFamily:"微软雅黑",fontSize:12,color:"black"},show:!0}}],series:d}}),charts.push(m),$(".more-button span:nth-child(1)").hasClass("active")||$(".more-button span:nth-child(1)").addClass("active"),$(".more-button span:nth-child(2)").hasClass("active")&&($(".more-button span:nth-child(1)").addClass("active"),$(".more-button span:nth-child(2)").removeClass("active"))}$("div.focus-loading").hide()},error:function(e){console.log(e)}})}),e.length<CHARTNUM&&($(".more-button").hide(),$("footer.footer").show())}var method=0,methodRange=["auto","h","i"],period,periodRange=["1","5","10","20"],source=2,sourceRange=[0,1,2,3],sourceName=["*","guba","(report OR announce)","news"],sourceShowName=["投资者总体","散户群体","从业人群","新闻媒体"],CONCEPTURL="/cross?id=6&",conceptList=[],conceptIndicator=0,CHARTNUM=4,HEATURL="/cross?id=0&",charts=[],loginfo;$(document).ready(function(){$(window).on("resize",function(){charts.forEach(function(e){e.resize()})}),window.user&&(loginfo=window.user.replace(/&quot;/g,'"'),loginfo=JSON.parse(loginfo),delete window.user,console.log("user",loginfo),$("footer.footer").hide(),_renderConceptList()),$(window).scroll(function(){$(window).scrollTop()+$(window).height()==$(document).height()&&($(".more-button span:nth-child(1)").removeClass("active"),$(".more-button span:nth-child(2)").addClass("active"),_renderCharts(conceptList.splice(0,CHARTNUM)))})});